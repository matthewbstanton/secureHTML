DROP TABLE USERS;
DROP TABLE DOCUMENTDEFINITION;
DROP TABLE DOCUMENTDATA;
DROP TABLE PERMISSIONDEFINITION;
DROP TABLE GROUPPERMISSIONS;
DROP TABLE GROUPS;


CREATE TABLE DOCUMENTDEFINITION
(
  DOCUMENTID INT PRIMARY KEY AUTO_INCREMENT,
  DOCUMENTNAME VARCHAR(15) UNIQUE,
  DESCRIPTION VARCHAR(60),
  PERMID INT
);

CREATE TABLE DOCUMENTDATA
(
  DOCUMENTID INT,
  SECTIONID INT,
  PERMID INT,
  SECTIONTEXT TEXT,
  PRIMARY KEY (DOCUMENTID, SECTIONID),
  FOREIGN KEY (DOCUMENTID) REFERENCES DOCUMENTDEFINITION(DOCUMENTID)
	ON DELETE CASCADE,
  FOREIGN KEY (PERMID) REFERENCES PERMISSIONDEFINITION(PERMID)
	ON DELETE CASCADE
);

CREATE TABLE PERMISSIONDEFINITION
(
  PERMID INT PRIMARY KEY AUTO_INCREMENT,
  PERMNAME VARCHAR(30) UNIQUE,
  ACCESS VARCHAR(1)
);

CREATE TABLE GROUPPERMISSIONS
(
  GROUPID INT PRIMARY KEY AUTO_INCREMENT,
  GROUPNAME VARCHAR(30) UNIQUE
);

CREATE TABLE GROUPS
(
  GROUPID INT,
  PERMID INT,
  PRIMARY KEY (GROUPID, PERMID),
  FOREIGN KEY (GROUPID) REFERENCES GROUPPERMISSIONS(GROUPID)
	ON DELETE CASCADE,
  FOREIGN KEY (PERMID) REFERENCES PERMISSIONDEFINITION(PERMID)
	ON DELETE CASCADE
);

CREATE TABLE USERS
(
  USERID INT PRIMARY KEY AUTO_INCREMENT,
  USERNAME VARCHAR(30) UNIQUE,
  PASSCODE VARCHAR(128),
  GROUPID INT,
  FOREIGN KEY (GROUPID) REFERENCES GROUPPERMISSIONS(GROUPID)
	ON DELETE CASCADE
);